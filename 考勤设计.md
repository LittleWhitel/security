# 考勤
---

## 打卡记录表

![](./images/001.png)

---

## 1 上班打卡

界面如下:

![](images/002.png)

1. 队长打开上班考勤页面
2. 设置打卡时间
3. 选择项目（调用接口1）
4. 光标放到“请输入卡号或工号”输入框内
5. 打卡有两种方式：（调用接口2）
    a. 队长手动输入卡号或工号，点击打卡按钮
    b. 员工刷卡（刷卡的卡机会自动化做两件事：一个是输入卡号，另一个是按一下enter键）
6. 刷新显示打卡记录, 状态全部为上班（调用接口3）

*注：多次重复刷卡只会保留最后一次*

**接口1：通过队长工号查询负责的项目**

- 接口名: /project/getByLeader
- 接口参数:
    1. id 负责人工号

**接口2：上班打卡**

- 接口名：/workRecord/onDuty
- 接口参数：
    1. userId 员工id或ic卡号
    2. leaderId 负责人id
    3. projectId 项目id
    4. startLongitude 上班打卡的径度
    5. startLatitude 上班打卡的纬度
    6. startTime 理论上班时间(yyyy-MM-dd HH:mm)
- 异常类型：
    1. 33, "打卡失败, 用户不存在"
    2. 72, "打卡失败, 负责人不存在"
    3. 73, "打卡失败, 项目不存在"

**接口3：通过负责人,项目,打卡状态查询所有记录**

- 接口名: /workRecord/getByLeaderAndProjectAndStatus
- 接口参数:
    1. leaderId 负责人id
    2. projectId 项目id
    3. status 工作记录状态:0上班;1下班;2缺卡

---

## 2 下班打卡

界面如下:

![](images/003.png)

1. 队长打开下班考勤页面
2. 设置打卡时间
3. 选择项目（调用接口1）
4. 光标放到“请输入卡号或工号”输入框内
5. 打卡有两种方式：（调用接口4）
    a. 队长手动输入卡号或工号，点击打卡按钮
    b. 员工刷卡
6. 刷新显示打卡记录, 状态全部为下班（调用接口3）

**接口4：下班打卡**

- 接口名: /workRecord/offDuty
- 接口参数:
    1. userId 员工id或ic卡号
    2. leaderId 负责人id
    3. projectId 项目id
    4. endLongitude 下班打卡的径度
    5. endLatitude 下班打卡的纬度
    6. endTime 理论下班时间(yyyy-MM-dd HH:mm)
- 异常类型:
    1. 33, "打卡失败, 用户不存在"
    2. 72, "打卡失败, 负责人不存在"
    3. 73, "打卡失败, 项目不存在"
    4. 74, "打卡失败, 上班记录不存在"

---

## 3 考勤记录

界面如下:

![](images/004.png)

1. 队长打开考勤记录页面
2. 选择项目（调用接口1）
3. 状态下拉框包含4个状态:-1所有;0上班;1下班;2缺卡;选择不同的状态查询不同的内容(调用接口5)
4. 刷新按钮会使状态下拉框的状态置为所有(调用接口5)
5. 单个删除(调用接口6)
6. 单个编辑(调用接口7)
7. 批量删除(调用接口8)
8. 批量编辑(调用接口9)

*注:每天下班结束, 队长都要处理仅仅打了上班的员工, 把状态修改为缺卡或下班*

